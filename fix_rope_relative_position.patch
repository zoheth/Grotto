--- a/grotto/modeling/modular_action/view_control.py
+++ b/grotto/modeling/modular_action/view_control.py
@@ -277,7 +277,14 @@ class ViewControlInjector(ActionInjector):
         k_ragged = k.reshape(BS * T, H, D)

         indptr = torch.arange(0, BS + 1, dtype=torch.int32, device=q.device) * T
-        offsets = torch.full((BS,), start_frame, dtype=torch.int32, device=q.device)
+
+        # Use relative position to prevent overflow when cache wraps around
+        # Calculate position relative to a fixed window size
+        window_size = getattr(self.action_config, 'rope_window_size', 24)
+        relative_start = start_frame % window_size
+        offsets = torch.full((BS,), relative_start, dtype=torch.int32, device=q.device)
+
+        # Note: This assumes cache size matches rope_window_size

         rope_theta = getattr(self.action_config, "rope_theta", 256.0)
         roped_q, roped_k = flashinfer.apply_rope(
